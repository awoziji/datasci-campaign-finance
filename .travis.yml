language: python
virtualenv:
  system_site_packages: false
python:
- 3.6
services:
- postgresql
env:
  matrix:
  - DJANGO_SETTINGS_MODULE=congressionaldata.settings.local
  global:
  - secure: NvqQ/BG2W1F6MqfXLwR0Im1UIIne0GZhYRzJHkRyjJNiJPEtnnXx+k5KYZj0OBg7vTwtyHabURHmuW3RrQKK9q0BHfFKrePRAYsMWhieUTzvYh3hpvpS8xGlRMiNyY7ZpLkeF2liH8u13vwVMIbFxxVWV382C1b+3ssTMzSt+kIzpdnzpc5jKkqauiP+NCwR8bIH5x+LMYzekPS4R1GSGhwQYb6eeU+Ftz0M3KRrm8bp0KujqWlLQwDGhLVQ9k7p/gGNWu0ghClH6tjIcLM7ZNOhkCtVn9hX3ju2rT+pe9jzg79iTWvLIAmcznK+4pKJnswT0MA2Sj75X6PukI5nWesrQ8KYY3g4nQ9NNZlsFV1E1PE1RaOq0LpWQ8eeWb4QQh97uqH1U3qt8hjcwyTKMqNYRRW1cZKf2aazwPmxZnnJiYdoxIz15AvP+cQaEJLnVW0YudnH6iRsWGD8bANzYbPeL2cP9Zrc2tAOory39cQJkm82eOxYKcX/Hi52oaEVbvOw0M3eIjWyoL807HYRlo+D2L+nlF4NDijGQiSMGPqeWVwgpr9eWVwEw/AZ67EuRKxfGLz/OWx/9DlZD8RCUkcUDWm8oQa1Adlwe/cSJ1taCrQ+/A7wxDq2wTdzDqfw6HtzyDdSucUFiELvMkiCI8XNaoUV4+B/Slnr3eoYXLM=
  - secure: sk8LHR7oIZCfY2Qn75B5/ZVGXIXOdMCHtyyXAwmTi/PirY6+gaBXbraIkEknd63AfLIYuJxeOLb6jKSzNHEWtFVApmLOhwh+ZxS8Qwlp0kcig2qnedWEZ1wb0muX6bWJswrScfEIhrz17NjHfJpASV3tUlEKUVrIN0+sJ2OGgQ6ehrMzQ8+Ya5+c0rVA/oo5R99b8HP3KgKPpMlus9REep5npPKmgwTBOvFY3b0yTOzxDGm4cCE5G4NgE0akscaRVCCsKT2cz3mz6Z4OwZR4vaUgZ/QRxJdAjI4uPAjeCtNxn+jsxyULtkXGDE2X1ZdE3NIV8l30DzqdUiKPz19H2xjC1KcJaegzuJ5p0OPcyuqv/5yS8mjZAK0FPLUksf/jITPBMhAvS6IiRPQEt0dA+MFLHl18ANBGi9AZuOMyMl2Jq9d1o6eN04JJRkCeLp9nxWSccti/919u9Prc95J1bM1vBU8tU5XFAsV1QZF7Yu131vjPhD4GVVLRk3wV+7KDp8Ztl5BO/h0caRTJUn9nJZxk4tHyhiL86Lq9JbQLtsJlSJfxl7LAaBkWNHHB4dYtv+xI4bPGoMDzGTIwwsCaUWB6T8ruPEI1xuvFd1AheAHALFNsVOmTifVyAMnXVFVO6e0zUNIEmCX1pqEMePt7hJfLJnvqYnXjFxDqzPHzWH4=
  - secure: RKh5uGJXsZx3FwYrvnwd2gEyYeSZHZWPqeahGV1fPeC/I3Yj7ddJtPf6aUReTygedAL29FkWhaG7clJ9JobppCJADHjac3EqJ3nzHyHXEVHpHhKQAfCPg8TFss+1aXhUmMyW43A7qolQyZdAXP2RJ2FhQ/5TYJcghIBI/ItR8T6Dlj3oHIanpVC1uDDaDoBzf7PzkiJfyXGWAiCqlRuMUX2C2dofL4NSgJ2N/+cGGVUVokQ5jfVRCvArcB5eFrxitN5ryFhKDts2/Rh3V41sihhBbKJJfev68y0zZSb/MDmXsCZES1QhyZ+QMSsMkjgpujWNEq8JRgLXI5QpB/dq4fvoemxnkb6ENsgHSAllYJ8ixzslDx+kcNXuqG0ipNj1N9W4l2+ZN4AZTGTVB6U3/hUhOaAJtTyf4YTkgyPjSVTclgu1wKqOl2Ryk44XyflRctDLoi64dZAp55LddrrVy1c8+2fiERKIAtqmD9u6zclfTjjyyKjYtyMnm0bNZYgy79LvRCrm5ztAwXX6Ih8W8BGBv2NIeZv0yb1shPsUfxMk78xoqoFELLkll8a+qboIo7KbobW/QJTQh4BPqu2WVFd/T8t65E/jMVYEh/b6zz8Y64EelWiYAQ0VmWOfDiM90a3dRyBNNN370vmWysDuvoW9NVa+Xpt98a0VlQ8CE3A=
  - secure: t/QOttajEfGySZU9TbX+dSJfO7n7ZyzKuOLC++N2BXxNdTF6/yE1Fu1WrjMkTzo++mIDNj9O8Bvmo9pOGMY/36Q6tGDkTK2X1Bt00BgeEGsmdZK50c7G1eOAI0AwfzjpJ99QIUVGK20BPHSLMIMYIzgHKpDKhcq3juO1aHIJa3xWCl383LB617csTJjSfxPG5YMLbtOiPyQmP8Z8Q9QlNaW+C0gBNJFty0+pf/d7Zja7ZFX4jgWke1Hubg4vswemYVgW7iCnq5PCgg8097SEy5VXTZ+uVx0Znbf4g9PokRz/rep6pZgg8a6S8cdLIz+EFzauwczPycUwDPtbndI48OPKM6wGryd+sLXFLgRnE9H2ltNMEgdNCEyCQIEzxlh9Yym0Uph+zW2EU+hdB4qiQJjjt5tWfOsNc8MWe32sz3K6OSGV6Xch1MWVhbxVPjdTOujSwmHA/30YmhLhpdy1YuR8L7tpin/8y3D7KAmg1/qpKzrA9xB1Z2rSnuPdhqwCUvTdrpSXly+zayf0vZGptQAn0CromscQsdEv+9xFi1ADF9vHn3mqZ4kS0VpbEBKhKTFVVOWV99lX4D65NFFMR+tzrwGyQN7aXuqRHZdMG/u4pZzHky9rGy1DUAoPPyDA5sDq3Jlr3oTFDEn/bDf2NlF9+BkzCSnXVKeh22CbLtU=
  - secure: q4N03301JvVXzzJsIpF9+jWlma/zyV8jLjyj/HNxTkd8MvzDn6Wo9GjU6iagjjlGuFB+zo6T/AQvC48p2XklKB+vQw2OG3JMzciclqjze4+MnEwIlxJya89bfsMH48bBQb6MzuWDjZ5Kvkl94Ihx5bIFVB7M7rtADtsk18WA/Q6df2M4K9uqcoLUrYES9j9y0Ia+D+FtfTzNYpGqhks8gSWxQjgyrOqgOFg+ZjRe0OyReXvQ+yEwAC0bWKiLs22JRKv4BJhwSs1dMuXwfHpZRp+ECe9tM/ua3cPD1ZiJUJinn2N4w/JM+ZGKpaLkHetA5BuMFdB5AJUecjL+rYyKSGOK0mc+eYyu+KDknVRs/94Fu3udJEIXZnjtIlD1qk44xQGgZoKMBX8xowpqdBMqVT7At2Nu3XcFyuaYha6IKgsDrG3R+sUOzfG4bUnCQ71ti61gSZCiU/HsvBPkdt0Wvq3prt2MliKT3tg+E1D/59svapPVNG/61YZYUGcbWAocmC8mHkHP8CwUDzdKSi0H1+cDURfmWKU2ymj14vV4lzumm5cVHNbRB7+lGg1UKaKGzpp9uIGLGhT37U7CcXhoLkfkUYEj3eOqA+Fzy6Qm4kc3YnO87uAhHXzne8yZKQQ5rNoti/5I4jIZtT+yWOmCgbpgy8zGrOiqHgNnz55BGBw=
  - secure: 0qncmgDrBBdLfqq1gpsyuIiYHJkJPhugXidULAJisuzQdXtySCHLua9QxhGyiz3v08WfXsMcnnhWCSRYz8WYbQNzbhFxXdbNBb/w1ypPrMetxSjlQm5ITpu+OWqE7uBgMOPp+u7lI2cqc8jbBXW8bsTtGdM240WS5J+kSzzXrnSpOobdF/6C7NMMOvfiGQ9EFUlwIT5CvnJ8mG1hHN3+v1yxVg5rx4s+QZVUaX/qnCAKKLD9NlGNUW5WGNgkde5U1zsNexAikGXu3J6+Kd6bTZ017967EiUBOWFbLWwhtPoHoNxm/qTx4YIFf7dIl4erqzO1r3xo08naZ+aSeKlww/NMFavZ9W3LWa4tZITFpMD4DnijG5bGOfteVLF4FSPZwTmTckUd3QYCwY7C3jVymzKbVZF8qRyR6b+WvmqhLsnnv6E6YZXv4sNR6m2x/yGeMTUOQGwmDywi5OfTpWZGVgKTIz1V4Z9WN6U2I7ik/F02/7qqHg90g2Hwrf6vxDSl3UEVNNrlkVg3PCaS4zysiF8DKJTC86X8DfTJokvO+LnVr91Upb2Qm7weU6IdZy/Gf1SYR1U+Y6B7Rm9nCuP23zHrbKDHaW9LYxMJsg5EVSRePkj3NuRClnLmd5tvyfvlD4atM+fFlGjntVD2CYk+kP91Hgx5qLiUBd3P/CFYKns=
  - secure: lgK7/mWz+FD2eJUd7L92WHLSWacrVeV0QZV/BogzQIPItyqIdqb7uAl3NoclWyYPijxswKjl6IMLIIZMznAIRsGkp1/FoPnIS/BlBgdBPG2nVMf7lvOfeernRidY0/dLX/ZnE8E/GaKHYjxsJw8PYrK6EfgyKE0s9A7dmtwa5DADY/U6/5bTYYuT3OyPvYFq5VYWYBwHLqmYUv5ud54lwU6w5DgHzaBFO5LvrHC1SSwQ/cyoquf2aGDwB3H+rQI8YW1ckJr+hTfXvBWiVSOXAhUl/lORimwYSPHohGhHnF9sLXg9MeylMs5POkVE+lHKAasDgEpyiE2A4tu02iKnJ4m3NvuYRhvvdbEkanae28HP0rdAyx8I4FNOHMKxvTRi3PesVplAE3jpJA4yrG/i9OpJp/Xyjw6nlETy38x3H/z47EqNFzsy+HvIfR6N0KGOc7FL5tf2FYppmBgFTM1OWVHvJ9WLzadx4TM3kuM/bgqXtTPFh8NyOkemg7mB57aaeqiBK/ivHYCBwF4Qqy7QlBTAoNK8Fb1vuaxCioTyBoQoF/dhEEBODulZpFeolzDbQKddyAJPLez0UGIBPDNgyRX3bomVL9C0Fj0Ln3GigXzjfE5LbAYD36LlXKZX6h6JAGvrzlPtetOnZXPeNwj3Q7ViiMisZXR2p9PzZvQNW8Q=
  - secure: Gj8gNEn6uhiKGEfmjqBzhYjPogjM9wJSafhbx3OGzCjPg2a1Ineii4p8Vmpg7k8VwDL4o6FJTXGHlzIJMv2BFwb8/DS15rMlLIUYhOhH6ZbmSQ9dWkL9iIXaIIAESeuYzkkjvdjJ+aqrdTK2CRxP/ajQXZ+glo7ajtbZysOSPwf5sMaQn8GyATLZ8cBaq0sOba/vZBbvvh7KIxc3uYFBrneRS1coDeOeLo0BR1C/6aF3hZHN9vUJUaWDtvHq7QNF0Eytf0Ne5pjaiTM5zQkhB37VQSpUVpmJRV2ScNWWjN6ypwlzwDGeor5mxz1gJyueQe+ZNhmSV/BA76D2HuyZ4BVUYLQmXNmZPn5xyFS4BUSLMCm04hNZp1Wqismlp+YVoXeVIuJ8leZGQ4KndTsGzwvhEWJJBY5zIpHVsSkS5wMJJO9vBBGG1ZH78G8cuoJG75+IRMzPm21RfsiOnhgFcg/BmatIflnxfo2/XAiGdgCRHuRL8lPlrFS3RK1V5dEwCsqgmT9+Dktdz2z9a7iomJN4WBw8e4GSM3MYCnddv4dWpgubf5uRiKraiGDo/f5jA3ikoAZ5GLoufGQ+/DradxAqAHgtZpM0HSr6a6BwL0AmeftN4OTZumxOtXAHvhraYNfVg/dk2qvzNtO9G0LbwvSNlAEKM01Ljv4ed+Yar/Y=
  - secure: GPsn7KVLb8ayvTLepqSO/o4y3as+hQ31I1fq7r9IddGH+AZ78yP/hUsuCiwy8mlkOxsvZTRnnoFVlG6J3oZNh+NfZ4bxCBegk9cFR/om36jFpRH2tWWTwc00D5rM6pPELdHHBheMMyzBxbQeYnGuYuGWZdsyBSjAaFuJqMkd0O3KsYwDCkf16w9n22Irxms3Jm9ahYtJQaNyRQaPWstgXvTIYzp0QP1PNX9kmiHZLbhczgh5wR3BFhFriEpNdrupDX+ycAZ6ChwaqSIlX0woicT3+cDft1HIr4R++kp2Zk9Rwuu1m0urcyjDGQ7JU5vJm0saVnyR4jNh8nSkIA23QAQF8I0KuFP/Psc0R+PI3sk3DN2AvvzFqXIVqCQ7wY/c49C9tpQskMz4YoRwdXpPClOs2ovoFR1Wy3/VISyC81XS4sg3wCk7Sp98B2+5YuLyML0B3KG7bMq3Wz2xip4D3U0bG1bJ8jihU+dqV8Qtj49bXG0et/WeAOlMxo7jhODsarAx3Q13xbK5OT6+7Nq/cMFIbTrFUMmnF5OC6xYLJKMT6I5HHCHlevcryHJA00t7TcnWyneRW330wXqZpbSu3bAJPIlf4vJJu609R2lwOofA9yulyXSkTq2FjFs9CONpgNa5poOZ/dF9K/KLCmOatXTVeqzyUkoWCbGYQE6GUB4=
  - secure: IB1Bh/Yq46fo6QzFrhA1mkYXpI1QgMf8z4rbN5G1SRde5adgFDoER/8UXfZGoISFYmDjGZkR/SdQTuqS7YNGYqmEanm9vzMKHs6XAYj4tpt7MRq3ETGEWTBgUPd0U801AG3ge7z6ZG2w/BqXjNL49BilSU8IEHC5hUhT1NDXAPvdPUpAaHSw0SaebW9onMVAnFEtjI9sCqAMmqv2RVMH1IeRbOThVAB+GuJhD9nxenqlgJh+wMq/sxG4heZMIcC3cnrNJwj7Pmxjr9FgP9spv19NA8a6cihDU6Yv5EyyBSxBBWJMdbRJBgqYB2BTJkWFrJmVz2njnGY2BUs6DmyxkhrSPvJMAnaVRz75BaFQ3JZdcwIsLQs51A1TKmkWaLlb0NETLChyGEOSleJlcxNdYkRbosTxYSiT3LoZdovVdkGCQ2dsqHyphWbSzl8MLxwpN2f7XO7wML2xPuJlxld084WT0tmYgCGkl9DYFzVOrkthwNcZo6rjQz3nsitzlqZ4+205Od4EV/DcAYyvJjeUcWzNWrC2lIDzztaDDVXVuWPmkyRsqb3PgARwS5aAUTBBVViE0GZJrperPjnCjNsKsyoqQIsIUVzFcosGs7UO5sBVzZHj8jWrBrFj4wmCqSem5EiIkSWx1p3B+jc0Ylw2W5zLiycr4sqwUh4eZfBZPKs=
  - secure: FV929osRySw10N5W+0k/1UlLoU+AmiYpatZ5O9v1GTC8BSxCt5/OXG8yp90BabY7nQf6kIHaFUDsnZLhW+DX8gD3vDd/VUDHiDP/4yiNv2vo4TR6oQ7O6muzShWyPQb81xOTwUHF6+BVtSPsue+PmOjOmCYVuuBIaCZVa2uIz8oE7eeTs+rgMCj5cvcFWhHEOed6Qs37tEA2vlEBmiRk0KWgN0UC8vm964f21ZKX/cTz8tN0PSnWw3SzoQFFHBgIVI/cE3bE4xiDMfaZ5Ur+x6YDQTgeixtUGLxo0GV2bChrb+mSiJPkLjKq+IaDqnJUevE9MwSZNkKTYXReTVlM4PgwUbJQx/fvCb0KMDdpr/SegI5BCn+OAbWeGbOICCt7r3FR0ovs13LtZ3mnQMl/2G7JvsmqO6b5GGTaEkYp7KceWGHNg/NgfvQzaiR0dSeB+9hjE8jmZH0YXuvFUt0xZSLaXeNOnEWj5caCWESjunI5NGVXdPOu47qDrLW5NljSmjt72JGSoFbTaaniMs34TuAgrtvAO6ArM4LhKbfrT/zLP3GMDb8vcJWySILC2NbZ2ProJka6iT98t0Pu12tMczqaCM4BN79ndIpAmal9yYhMaftNIqIoIMsNUTk3WCvn+Gw7zFWVjTnRn7Ib1kQC+vacbj3lsWZkyHSIjrGzkfs=
  - secure: oaQE9BWGVCBxlAMYraKKBH7BgWY51oBGj0ySu2ESBTE/cXE2/G9dV2lWxcxyIKWdUT9l9+BkG81GMzYjOprxTnnsjr0kwJx8iTKbuxTyp2S0S0YgzskvfpDf7/cLLWoYlbEZOjQ3zTrQPmVbJUtFukMx4jd6CD17I6Hrn5SFCpmam3c9V8JhKzxDvm0Iq8uFY04B96N+rwksSBJh7LNxJI8Uhv3KwSMtvzEDtrfqxYe7MWvmN1eY64Pjkcaw1WyBumbbocBKmmWXLdvEWhB2Rc+dnFH0X5kmkz0y2huK4RDKj6dzTJHjAa3FiFoI1A+cf5oOkLAW4D9lgq/UpP/k54sSucOt5nXS9Xdf9gi3iUwB+n33PZPGw7uCt4as2lib65puaNGjqaDLFEoxwCgP6JcQRHaFuLRU632djGXIb+50bR2Nx3+L+qejQXGMoV3yAeGJIzOQjBWmqVtYgAA+XBtMl8SH1Qdr9J77vq7VCrRY0qYM66Qjon53geaRUCj8PSLzzkDotJw7LyUyHg7hGtb7RH89KsDuoQl3QqhM8sjuyUHb8EqY4j9XFl+X5lTTgh9DKkzxYE0i6z/v39+gfGItzCP5mu6mMlT6liX0jAVxCjHtczC0lEPRu8xc/OIK9xEIUayZzz/XK8URryYvmkJN91JNZilzLwJRaOKqug0=
  - secure: pi4mANTOjiLe22Nbny3boEDCQqU4PvxBID+EW6VNyMNkDscww70WikD+cv60fxqkyQTFJ2E7J+isapwjPLrhtoaeK1kwVkIkGS+NAXWE4oMfKHUpqmA5XDrBZMQr4FDEwpK4+DhSn5GKl9/fgJE1ZQhOnzvXhd32vo+NOFwMfbKPTylLDKKZ07h7gLi47+cLdoYDGH+NbDjr+NJCTkiRZxxM8wXW6Ftav26tELUqcvCMcv2ONgtG9X2b7Yko0LkHYYFbet0W8zHBkwYAOjValua3WQud73U9qAxkkyRwuk4VuZQth7NK2jtoAQmmKyDUhC7fE8sozMhqKUvoLqYBdOYdMtXamNcXd+8C/Z+PQ5BZoWS5waP1uEu3PVz3GFqqiv2MAkSNhpY6D+rjk8ZbUZ8jHVIK0cdiRWNnhwkMWmbJJQ/vb1Q0HxQvsQJzD2kqfXeDX9MdW2GosGNYe0R1kAbTy6W86+dBSVsc9WGKLMUbKlmlA4cCwvcrcY/yqpe64xaskUCSdPp+ZHeOd1EhciUO4VK0JuPzTRq4hAHMTIkWe3FZQG7a4UgpZYyUGpIYdt/5n6wgSuE2dafsSZIw6BV5pqRPSsPtPI3I2MbxOEdjpyI3YYS4yqPDUu54otKEYc+JWJ75eGiGKMBrxvjj8HojWm2JKiT/MTO8kGdzlCQ=
before_install:
- cd django/congressionaldata
- pip install virtualenv
- virtualenv venv
- source venv/bin/activate
install:
- echo "$LOCAL_POSTGRES_DATABASE_NAME"
- pip install -r requirements.txt
- pip install -r requirements.txt -t lib
- pip install coverage==4.5.1
- pip install python-coveralls
- pip install pycodestyle
before_script:
- psql -c "CREATE DATABASE ${LOCAL_POSTGRES_DATABASE_NAME};" -U postgres
- psql -c "CREATE USER ${LOCAL_POSTGRES_USER} WITH LOGIN PASSWORD '${LOCAL_POSTGRES_PASSWORD}';"
  -U postgres
- psql -c "GRANT ALL PRIVILEGES ON DATABASE ${LOCAL_POSTGRES_DATABASE_NAME} TO ${LOCAL_POSTGRES_USER};"
  -U postgres
- psql -c "ALTER ROLE ${LOCAL_POSTGRES_USER} CREATEDB;" -U postgres
- pycodestyle --exclude=migrations,lib,venv --statistics .
script:
- coverage run --source='.' manage.py test election_data
- coverage report --omit="*venv*","manage.py"
after_script:
- deactivate
deploy:
- provider: azure_web_apps
  verbose: true
  slot: "${AZURE_WA_SLOT_DEVELOPMENT}"
  on: ci-test
- provider: azure_web_apps
  verbose: true
  slot: "${AZURE_WA_SLOT_DEVELOPMENT}"
  on: develop
- provider: azure_web_apps
  verbose: true
  slot: "${AZURE_WA_SLOT_PRODUCTION}"
  on: master
after_success:
- coveralls
notifications:
  slack:
    secure: KiRqrqp+qAX6ieUswh9dgCkLwz0j2i38djZiYezTBPP2gjCQrz442rJ5+ayIJ0XGjEScTfnLrm8SaCnCkMOe09e5yZ4LFx00rhRcT/XSqG2/IVArlsu8Z9Mzvl2+Q0gbP5N6NH8VdELV5a+zkQoXfQSASQv7h/pxXx4j9xmQ+1kTYY6Zv9JTA5MreqLvMrsvjE3bOTvxF+8vDR6SsiGPyPSGl7FHo8LgtVdhYxy/l3+dnlXHBm0C3Hpq8gLGl4STQ059nnY8sB3y2g6Ccr/h3DfVGc+SXUS6CFQwK9DjZTUsXlEuIoUchgsFlKUsCrNiDBi7RCds7YbB1a74YjuiPBcez5vFspX0qi4qTmHrpKVEX8k2+pTdBLAxu/t5ZMZXapauindBZf2abj3Gad6EhS8kiWmZb5+QAoqylfgk3WaxAgDNNa2EWdSr5YXX/KyVqP2CRTbqo3Vh0fZgpeKjssxa4ua8yLe7MVo7SdKTzzU3sJkdUXP6OO+7EH1P5V+GEOaRUkh4nG393aaSsF4nvLXeY9legvkQDjAXDFxPnBjUdjYT6xjsc1npwcdm4YL7UwW6xP+Y+nm5tCEaGOe9NcznB0agYf/o8d7UByMs1XrsnLmeplNKNqhXKkaGeTun8O4F3D2p37mhq2MXD8uB3skDe2IjWu0JJWGur4ImDQ8=
